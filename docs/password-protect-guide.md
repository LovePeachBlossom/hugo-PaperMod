# 密码保护功能使用指南

## 📋 功能概述

博客现在支持为文章添加密码保护功能。访客需要输入正确的密码才能查看文章内容。

## 🚀 快速开始

### 步骤 1：生成密码哈希

1. 访问 `/password-generator.html` 页面
2. 输入您想要设置的密码
3. 可选：输入密码提示信息
4. 点击"生成哈希值"按钮
5. 复制生成的哈希值

### 步骤 2：在文章中使用

在文章的 front matter（文件开头的 YAML 配置）中添加：

```yaml
---
title: "我的私密文章"
date: 2025-01-01
draft: false
# 密码保护配置
passwordHash: "生成的哈希值"
passwordHint: "密码提示（可选）"
---

文章内容...
```

### 步骤 3：测试

1. 启动 Hugo 服务器：`hugo server`
2. 访问受保护的文章
3. 输入密码验证
4. 验证成功后，内容会自动解锁

## ✨ 功能特点

- ✅ **按文章保护**：每篇文章可以设置独立的密码
- ✅ **自动记忆**：密码验证成功后，会在浏览器中记住解锁状态（使用 localStorage）
- ✅ **美观界面**：密码输入框采用现代化设计，完美适配深色/浅色主题
- ✅ **密码提示**：可以为密码设置提示信息，帮助用户回忆
- ✅ **列表标识**：在文章列表页会显示 🔒 图标，提示该文章受密码保护

## 📝 使用示例

### 示例 1：基本密码保护

```yaml
---
title: "私密日记"
date: 2025-01-01
passwordHash: "1234567890"
---

这是我的私密日记内容...
```

### 示例 2：带密码提示

```yaml
---
title: "会员专享内容"
date: 2025-01-01
passwordHash: "1234567890"
passwordHint: "提示：我的生日（8位数字）"
---

会员专享内容...
```

## 🔧 高级功能

### 清除解锁状态

如果需要清除所有已解锁的内容（例如更换密码后），可以在浏览器控制台执行：

```javascript
clearUnlockedContent()
```

然后刷新页面，所有文章将重新需要输入密码。

### 按分类保护（未来功能）

目前支持按文章保护，按分类保护功能正在开发中。

## ⚠️ 安全提示

**重要**：此密码保护功能是基于客户端的轻度保护，主要用于：

✅ **适合用于**：
- 防止搜索引擎索引
- 防止普通访客随意浏览
- 保护个人隐私内容
- 会员专享内容展示

❌ **不适合用于**：
- 高度敏感的信息
- 需要服务器端验证的内容
- 商业机密或重要数据
- 需要严格访问控制的内容

**原因**：
- 密码哈希存储在静态文件中，技术用户可以通过查看源代码获取
- 验证逻辑在客户端执行，可以通过浏览器开发者工具绕过
- 内容在 HTML 中完整存在，只是通过 JavaScript 隐藏

## 🛠️ 技术实现

- **前端验证**：使用 JavaScript 在客户端进行密码验证
- **状态存储**：使用 localStorage 存储解锁状态
- **密码哈希**：使用简单的哈希算法（仅用于客户端轻度保护）
- **样式**：完全适配主题的深色/浅色模式

## 📚 相关文件

- 密码生成工具：`static/password-generator.html`
- JavaScript 逻辑：`assets/js/password-protect.js`
- CSS 样式：`assets/css/common/password-protect.css`
- 文章模板：`layouts/_default/single.html`
- 列表模板：`layouts/_default/list.html`

## 💡 常见问题

### Q: 如何更改已设置的文章密码？

A: 使用密码生成器生成新密码的哈希值，更新文章中的 `passwordHash` 字段，并清除浏览器的解锁状态。

### Q: 密码会过期吗？

A: 不会。一旦验证成功，解锁状态会一直保存在浏览器中，直到清除浏览器数据或手动清除。

### Q: 可以设置多个密码吗？

A: 目前每篇文章只支持一个密码。如果需要多个密码，可以考虑使用密码提示功能。

### Q: 搜索引擎会索引受保护的内容吗？

A: 虽然内容在 HTML 中存在，但通过 JavaScript 隐藏，大多数搜索引擎不会执行 JavaScript，因此内容通常不会被索引。但为了更安全，建议在 `robots.txt` 中排除受保护的文章。

## 🎯 最佳实践

1. **使用强密码**：即使只是客户端保护，也建议使用强密码
2. **设置密码提示**：帮助合法用户回忆密码
3. **定期更新**：定期更换密码，特别是分享给多人时
4. **不要存储敏感信息**：不要在受保护的文章中存储真正的敏感信息

---

如有问题或建议，欢迎反馈！

